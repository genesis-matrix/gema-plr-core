##
## Salt Master Aggregate Configuration
##



## DESC:
##   - fileserver_backend
##   - pillar_roots
##   - file_roots
##   - gitfs_remotes



## File Server Backend
fileserver_backend:
  - roots
  - git



## pillar_roots
## - A base environment is required to house the top.sls file
## - the environment precedence/workflow is as follows:
## lab -> dev -> stg -> uat -> prod
## - this supports maintaining multiple versions of the same config in the
## same cfg-store, safely, for testing, without impacting more
## promoted a/o stable versions used by downstream environments.
## - For example, a UAT state will never be pulled into production, but in
## order to maintain a UAT environment, based in production, with
## only intended alteration, all the production states are available
## unless overidden.
pillar_roots:
  base:
    - /vagrant/srv/pillar/base



## file_roots
## - A base environment is required to house the top.sls file
## - the environment precedence/workflow is as follows:
## LAB -> DEV -> STG -> UAT -> prod 
## - this supports maintaining multiple versions of the same config in the
## same cfg-store, safely, for testing, without impacting more
## promoted a/o stable versions used by downstream environments.
## - For example, a UAT state will never be pulled into production, but in
## order to maintain a UAT environment, based in production, with
## only intended alteration, all the production states are available
## unless overidden.
file_roots:
  base:
    - /vagrant/srv/roots/base



## NOTES:
##  - https://docs.saltstack.com/en/latest/topics/tutorials/gitfs.html
##  - Per-remote configuration parameters are named like the global versions, with the gitfs_ removed from the beginning.
##  - salt-run fileserver.clear_cache backend=git
##  - salt-run fileserver.file_list saltenv=dev backend=git
##  - salt-run fileserver.update backend=roots,git
##  - salt.fileserver.gitfs.envs(ignore_cache=False) #Return a list of refs that can be used as environments
gitfs_remotes:
  #- https://github.com/saltstack-formulas/salt-formula:
  - https://github.com/khaije1/salt-formula:
    - mountpoint: salt://formula/salt
    - root: salt

